#!/bin/sh

echo "ğŸ” Pre-push ê²€ì¦ ì‹œì‘..."

# TypeScript ì»´íŒŒì¼ ì²´í¬
if [ -f "tsconfig.json" ]; then
    echo "  TypeScript ê²€ì¦..."
    if ! npx tsc --noEmit --skipLibCheck; then
        echo "âŒ TypeScript ì»´íŒŒì¼ ì—ëŸ¬"
        exit 1
    fi
fi

# ESLint ì²´í¬
if [ -f ".eslintrc.js" ] || [ -f ".eslintrc.json" ] || [ -f "eslint.config.js" ]; then
    echo "  ESLint ê²€ì¦..."
    if ! npm run lint 2>/dev/null; then
        echo "âŒ ESLint ì—ëŸ¬"
        exit 1
    fi
fi

# í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (passWithNoTests ì˜µì…˜)
if grep -q '"test"' package.json 2>/dev/null; then
    echo "  í…ŒìŠ¤íŠ¸ ì‹¤í–‰..."
    if ! npm test -- --passWithNoTests --run 2>/dev/null; then
        echo "âŒ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨"
        exit 1
    fi
fi

echo "âœ… Pre-push ê²€ì¦ í†µê³¼"
